# Эмулятор командной оболочки ОС с виртуальной файловой системой

## Общее описание

Эмулятор командной оболочки представляет собой графическое приложение, имитирующее работу командной строки UNIX-подобной операционной системы. Проект включает реализацию виртуальной файловой системы (VFS), работающей полностью в памяти, с поддержкой основных файловых операций.

## Цель проекта

Создать полнофункциональный эмулятор командной оболочки с собственной виртуальной файловой системой, поддерживающий основные команды UNIX и обеспечивающий привычный пользовательский интерфейс для работы в командной строке.

## Структура проекта

```
emulator/
├── src/
│   ├── main.py                 # Основной файл приложения
│   ├── shell_emulator.py       # Основной класс эмулятора
│   ├── vfs.py                  # Виртуальная файловая система
│   └── commands.py             # Реализация команд
├── scripts/
│   ├── test_basic.sh           # Тест базовых команд
│   ├── test_config.sh          # Тест конфигурации
│   ├── test_vfs.sh             # Тест VFS
│   └── startup_script.txt      # Стартовый скрипт
├── vfs/
│   ├── minimal_vfs.xml         # Минимальная VFS
│   ├── multi_level_vfs.xml     # Многоуровневая VFS
│   └── complex_vfs.xml         # Сложная VFS
├── config.ini                  # Конфигурационный файл
└── README.md                   # Документация
```

## Описание функций и настроек

### Основные функции:
- **REPL (Read-Eval-Print Loop)** - интерактивный режим работы
- **Виртуальная файловая система** - работа с файлами и директориями в памяти
- **Поддержка скриптов** - выполнение команд из файлов
- **Графический интерфейс** - оконное приложение с историей команд

### Поддерживаемые команды:
- `ls` - список файлов и директорий
- `cd` - смена текущей директории
- `pwd` - вывод текущего пути
- `wc` - подсчет строк, слов и символов
- `find` - поиск файлов
- `cp` - копирование файлов
- `mv` - перемещение/переименование файлов
- `exit` - выход из эмулятора
- `vfs-init` - инициализация VFS по умолчанию

## Параметры запуска

### Базовый запуск:
```bash
python main.py
```

### С параметрами конфигурации:
```bash
python main.py --vfs-path ./vfs/complex_vfs.xml --prompt "my-shell> " --script ./scripts/startup_script.txt
```

### Параметры командной строки:
- `--vfs-path` - путь к XML-файлу VFS
- `--prompt` - пользовательское приглашение в REPL
- `--script` - путь к стартовому скрипту

## Этапы разработки

### Этап 1: REPL
**Реализовано:**
- Графический интерфейс с заголовком VFS
- Парсер команд с разделением на команду и аргументы
- Команды-заглушки: `ls`, `cd`, `exit`
- Интерактивный режим работы

### Этап 2: Конфигурация
**Реализовано:**
- Параметры командной строки
- Поддержка стартовых скриптов с комментариями
- Скрипты тестирования для реальной ОС
- Отладочный вывод параметров

### Этап 3: VFS
**Реализовано:**
- Виртуальная файловая система в памяти
- Загрузка VFS из XML-файлов
- Обработка ошибок загрузки VFS
- Команда `vfs-init` для сброса VFS
- Тестовые скрипты для различных конфигураций VFS

### Этап 4: Основные команды
**Реализовано:**
- Полная реализация команд `ls` и `cd`
- Новые команды: `pwd`, `wc`, `find`
- Тестовый скрипт для проверки функциональности

### Этап 5: Дополнительные команды
**Реализовано:**
- Команды модификации: `cp`, `mv`
- Полная поддержка изменения состояния VFS в памяти
- Комплексный тестовый скрипт

## Тест базовых команд

### Скрипт: `scripts/test_basic.sh`

```bash
#!/bin/bash
echo "=== Тестирование базовых команд эмулятора ==="

# Тест команды ls
echo "Тест: ls"
python main.py --script ./scripts/test_ls.txt

# Тест команды cd и pwd
echo "Тест: cd и pwd"
python main.py --script ./scripts/test_cd_pwd.txt

# Тест команды wc
echo "Тест: wc"
python main.py --script ./scripts/test_wc.txt

# Тест команды find
echo "Тест: find"
python main.py --script ./scripts/test_find.txt

# Тест команд cp и mv
echo "Тест: cp и mv"
python main.py --script ./scripts/test_cp_mv.txt

echo "=== Все тесты завершены ==="
```

### Примеры выполнения команд:

```bash
# Навигация по файловой системе
VFS> pwd
/
VFS> ls
documents/ downloads/ music/ file1.txt

VFS> cd documents
VFS> pwd
/documents

# Работа с файлами
VFS> wc file1.txt
  10   50   300 file1.txt

VFS> find *.txt
/documents/report.txt
/downloads/data.txt

# Операции с файлами
VFS> cp file1.txt file1_backup.txt
VFS> mv old_name.txt new_name.txt
```

### Обработка ошибок:
```bash
# Несуществующая директория
VFS> cd /invalid_directory
Ошибка: Директория не найдена

# Несуществующая команда
VFS> invalid_command
Ошибка: Команда не найдена

# Неверные аргументы
VFS> wc
Ошибка: Не указан файл
```

## Особенности реализации

- **Полностью в памяти**: Все операции с VFS выполняются без модификации реальной файловой системы
- **XML-база**: Структура VFS загружается из XML-файлов с поддержкой base64 для двоичных данных
- **Графический интерфейс**: Оконное приложение с историей команд и прокруткой
- **Расширяемость**: Архитектура позволяет легко добавлять новые команды

Проект демонстрирует полный цикл разработки эмулятора командной оболочки от минимального прототипа до полнофункциональной системы с виртуальной файловой системой.
